(()=>{"use strict";class t{constructor(t,e,n,a,o){this.name=t,this.phone=e,this.email=n,this.address=a,this.description=o}}function e(t,e){return`\n    <li class = 'list-item' data-index = ${e}>\n        <h2 class = 'title'>${t.name}</h2>\n        <h3 class = 'sub-title'>${t.phone}</h3>\n        <div class = 'delete'></div>\n    </li>\n    `}class n{static login(t,e){let n=localStorage.getItem("users");if(null!==n&&(n=JSON.parse(n),n[t]===e))return localStorage.setItem("currentUser",t),!0;throw new Error("Wrong email or password")}static registration(t,e){const n=localStorage.getItem("users");let a={};if(console.log(a),null!==n){a=JSON.parse(n);for(let e in a)if(e===t)throw new Error(`User with ${t} already exists!`)}return a[t]=e,console.log(a),localStorage.setItem("users",JSON.stringify(a)),localStorage.setItem("currentUser",t),!0}static getCurrentUser(){return localStorage.getItem("currentUser")}static logout(){localStorage.removeItem("currentUser")}static addContact(t,e){const n=localStorage.getItem(t),a=null!==n?JSON.parse(n):[];return a.push(e),localStorage.setItem(t,JSON.stringify(a)),!0}static deleteContact(t,e){const n=JSON.parse(localStorage.getItem(t));n.splice(e,1),localStorage.setItem(t,JSON.stringify(n))}static getAllContacts(t){const e=localStorage.getItem(t);return e?JSON.parse(e):[]}}!function(){const a=document.querySelector("#root"),o={currentUser:null,location:null,contacts:[]};function c(t){t!==o.location&&("logout"===t?(n.logout(),o.currentUser=null,o.contacts=[],o.location="home"):o.location=t),s(o.location,o.contacts)}function s(t,n){a.innerHTML="",a.append(function(t,e,n){const a=document.createElement("div");return a.className="nav",a.innerHTML=`\n  <ul>\n  ${function(t,e){return t?`\n  <li><a href="contacts" ${"contacts"===e?'class = "active"':""}>Contacts</a></li>\n    <li><a  href="add" ${"add"===e?'class = "active"':""}>Add new contact</a></li>\n    <li><a href="logout" ${"logout"===e?'class = "active"':""}>logout</a></li>`:'<li><a href="login">Login</a></li>'}(t,e)}\n  </ul>\n  `,a.onclick=n,a}(o.currentUser,t,l)),a.append(document.createElement("hr"));const c=function(t,n){const a=document.createElement("div");switch(t){case"logout":case"home":a.className="home",a.innerHTML='\n    <img src="./img/contact_us.jpg" alt ="homeview">\n    ';break;case"login":a.className="add-contact",a.innerHTML='\n    <form name = "loginForm" action="#">\n       <input\n         id="login"\n         class="form-control"\n         type="text"\n         name="login"\n         placeholder="Type login"\n       />\n       <input\n         id="password"\n         class="form-control"\n         type="text" \n         name="password"\n         placeholder="Type password"\n       />\n       <div class="buttons">\n       <button id ="login-btn" class="add-btn">login</button>\n       <button id = "registration-btn"class="add-btn">registration</button>\n       </div>\n     </form>\n    ',a.querySelector("form").onsubmit=r;break;case"contacts":a.className="contacts",a.innerHTML=`\n        <ul class = 'list'>\n         ${n.map(e).join("")}\n         </ul>\n         <div class = 'contact-view'>No selected contact</div>\n    `,a.querySelector(".list").onclick=d;break;case"add":a.className="add-contact",a.innerHTML='\n    <form name = "addContactForm" action="#">  \n     <input\n      id="inputName"\n      class="form-control"\n      type="text"\n      name="name"\n      placeholder="Type name"\n     />\n     <input\n      id="inputPhone"\n      class="form-control"\n      type="text"\n      name="phone"\n      placeholder="Type phone"\n     />\n     <input\n      id="inputEmail"\n      class="form-control"\n      type="text"\n      name="email"\n      placeholder="Type email"\n     />\n     <input\n      id="inputAddress"\n      class="form-control"\n      type="text"\n      name="address"\n      placeholder="Type address"\n     />\n     <textarea\n     id="inputDesc"\n      class="form-control"\n      type="text"\n      name="description"\n      placeholder="Type description"\n     ></textarea>\n     <div class="buttons"><button class="add-btn">Add</button></div>\n    </form>',a.querySelector("form").onsubmit=i}return a}(t,n);a.append(c)}function l(t){t.preventDefault(),"A"===t.target.tagName&&c(t.target.getAttribute("href"))}function r(t){t.preventDefault();const e=t.target;console.log(e);const a=e.login.value,c=e.password.value;let l=!0;if(""===a||""===c)l=!1,u(l,"The data is uncompleted");else{if("login-btn"==t.submitter.id)try{n.login(a,c)}catch(t){l=!1,u(l,t.message)}finally{e.reset()}if("registration-btn"==t.submitter.id)try{console.log(a),console.log(c),n.registration(a,c)}catch(t){l=!1,u(l,t.message)}finally{e.reset()}}l&&(o.currentUser=a,o.location="contacts",o.contacts=n.getAllContacts(a),s(o.location,o.contacts))}function i(e){e.preventDefault();const a=e.target;if(console.log(a.elements),!function(t,e){let n=!1;for(let e of t)"button"!==e.localName&&(""===e.value.trim()?(e.classList.add("is-invalid"),n=!0):e.classList.remove("is-invalid"));return n&&e(!1,"All fields should be fill!!!"),n}(a,u)){const e=n.addContact(o.currentUser,new t(a.name.value,a.phone.value,a.email.value,a.address.value,a.description.value));a.reset(),e&&(u(e,a.name.value),o.contacts=n.getAllContacts(o.currentUser))}}function d(t){let e=t.target;if(e.classList.contains("delete"))n.deleteContact(o.currentUser,e.dataset.index),o.contacts=n.getAllContacts(o.currentUser),0==o.contacts.length&&localStorage.removeItem(o.currentUser),s(o.location,o.contacts);else{"LI"!==e.tagName&&(e=t.target.parentNode),a.querySelectorAll("li").forEach((t=>t.classList.remove("item-active"))),e.classList.add("item-active");const n=o.contacts[+e.dataset.index];document.querySelector(".contact-view").innerHTML=function(t){return`\n    <h2>${t.name}</h2>\n    <div class="contact-view-row">\n    <img src="./img/technology.png" alt="" />\n    <h3>${t.phone}</h3>\n    </div>\n    <div class="contact-view-row">\n    <img src="./img/multimedia.png" alt="" />\n    <h3>${t.email}</h3>\n    </div>\n    <div class="contact-view-row">\n    <img src="./img/buildings.png" alt="" />\n    <h3 ">${t.address}</h3>\n    </div>\n    <p>${t.description}</p>\n    `}(n)}}function u(t,e){let n=a.querySelector(".alert");n||(n=document.createElement("div"),a.querySelector(".add-contact").prepend(n)),n.className="alert "+(t?"alert-success":"alert-danger"),n.innerHTML=t?"Contact was added":e}!function(){const t=n.getCurrentUser();t?(o.currentUser=t,o.contacts=n.getAllContacts(t),c("contacts")):c("home")}()}()})();